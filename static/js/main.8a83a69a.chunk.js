(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(63)},33:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var o,a=n(0),i=n.n(a),c=n(20),l=n.n(c),r=n(6),u=n(2),s=n(9),d=n(11),m=n(10),f=n(12),p=n(4),b=function(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},g=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},h=(n(33),function(e){return console.log("allocationInfo: ",e),i.a.createElement("div",{className:"AllocationInfo"},"Next Meeting:",i.a.createElement("div",null,b(e.from)," - ",b(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title))}),v=(n(35),function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"AllocationInfoBig"},"Current Meeting:",i.a.createElement("div",null,b(e.from)," - ",b(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title),e.attendees?i.a.createElement("div",null,"Attendees: ",e.attendees):null,e.agenda?i.a.createElement("div",null,"Agenda: ",e.agenda):null))});!function(e){e.occupied="occupied",e.free="free",e.awaiting="awaiting"}(o||(o={}));n(37);var E,y,k=function(e){var t=i.a.createElement("button",null,"Not configured button");switch(e.type){case"icon":t=i.a.createElement("button",{className:"btn ".concat(e.btnClassName),onClick:e.onClick,name:e.iconId},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})));break;case"icon-text":t=i.a.createElement("button",{className:"btn btn_flat",onClick:e.onClick,name:e.label},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})),i.a.createElement("span",null,e.label))}return t},C=function(e){var t,n,a;console.log("Allocation menu:",e.id),console.log("Props: ",e),e.currentAllocation?(e.roomStatus===o.awaiting&&(n=i.a.createElement(k,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.currentAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{type:"icon-text",onClick:function(){return e.onExtendMeetingClick(e.currentAllocation.id,6e4)},iconId:"icon-calendar-plus-o",label:"Extend"}),i.a.createElement(k,{type:"icon-text",onClick:function(){return e.onFinishEarlyClick(e.currentAllocation.id)},iconId:"icon-calendar-times-o",label:"Finish"}),n)):(e.roomStatus===o.awaiting&&(a=i.a.createElement(k,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.nextAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{type:"icon-text",onClick:function(){return e.onAddMeetingClick(e.roomId)},iconId:"icon-calendar-o",label:"Book now"}),a));return i.a.createElement("div",{className:"AllocationMenu ".concat(e.roomStatus)},t)},w=(n(39),function(e){var t=["RoomStatusBorder"];return t.push(e.roomStatus),i.a.createElement("div",{className:t.join(" ")},e.children)}),x=(n(41),function(e){return i.a.createElement("div",{className:"StatusBar"},i.a.createElement("div",null,"This is StatusBar"),i.a.createElement(k,{type:"icon-text",onClick:e.onAdminClicked,iconId:"icon-settings",label:"Admin"}))}),A=(n(43),function(e){return i.a.createElement("div",{className:"TimeView"},b(e.time))}),O=(n(45),n(47),function(e){return i.a.createElement("div",{className:"EquipmentBar"},e.equipment.map(function(t){return function(t){return i.a.createElement(k,{key:t.type,type:"icon",onClick:function(){return e.onChangeStatusClick(t)},iconId:"icon-".concat(t.type.toLowerCase()),btnClassName:"btn_".concat(t.status.toLowerCase())})}(t)}))}),S=(n(49),function(e){return i.a.createElement("div",{className:"Header"},i.a.createElement("div",null,e.room.name),i.a.createElement(O,{equipment:e.equipment,onChangeStatusClick:e.onChangeStatusClick}))}),j=(n(51),n(53),function(){return i.a.createElement("div",{className:"Backdrop"})}),N=function(e){var t=["Popup"];return e.open&&t.push("open"),i.a.createElement("div",{className:t.join(" ")},i.a.createElement(j,null),i.a.createElement("div",{className:"content"},i.a.createElement(k,{type:"icon-text",onClick:e.onCloseClick,iconId:"icon-close",label:"Close"}),e.children))},I=n(1),R=Object(I.b)(["ui.time"]),M=Object(I.b)(["ui.selectedRoomId"]),P=Object(I.b)(["ui.adminPanelOpen"]),q=Object(I.b)([M,"room"],function(e,t){return t.entity[e]}),B=Object(I.b)([M,"allocation"],function(e,t){return Object.values(t.entity).filter(function(t){return t.roomId===e})}),D=Object(I.b)([R,B],function(e,t){return t.filter(function(t){return t.from<=e&&t.to>=e})}),T=Object(I.b)([R,B],function(e,t){return t.filter(function(t){return t.from>=e})}),W=Object(I.b)([T],function(e){return e.sort(function(e,t){return e.from-t.from})}),F=Object(I.b)([(E=1,Object(I.b)([W],function(e){return e.slice(0,E)}))],function(e){return e[0]}),H=Object(I.b)([D],function(e){return e[0]}),L=Object(I.b)([D],function(e){return e.length>0}),U=Object(I.b)([M,"equipment"],function(e,t){return t.filter(function(t){return t.roomId===e})}),V=Object(I.c)({slice:"room",initialState:{entity:{},ids:[]},reducers:{addRoom:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},changeRoomName:function(e,t){e.entity[t.payload.id].name=t.payload.name}}}),J=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).selectedRoom=void 0,console.log("!!props",e),n.selectedRoom=e.selectedRoom,n.state={roomName:n.selectedRoom.name},n}return Object(f.a)(t,e),Object(s.a)(t,[{key:"submitSettings",value:function(e){e.preventDefault(),console.log(e),this.props.onSettingsSaved(this.selectedRoom.id,this.state.roomName)}},{key:"inputChangedHandler",value:function(e){console.log(e),this.setState({roomName:e.target.value})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("h3",null,"This is admin panel"),i.a.createElement("form",{onSubmit:function(t){return e.submitSettings(t)}},i.a.createElement("div",null,i.a.createElement("label",null,"Room name"),i.a.createElement("input",{type:"text",placeholder:"Room Name",value:this.state.roomName,onChange:function(t){return e.inputChangedHandler(t)}})),i.a.createElement(k,{type:"icon-text",iconId:"icon-save",label:"Save Settings"})))}}]),t}(a.Component),_=Object(r.b)(function(e){return{selectedRoom:q(e)}},function(e){return{onSettingsSaved:function(t,n){return e(V.actions.changeRoomName({id:t,name:n}))}}})(J),$=function(e){var t,n;return console.log("roomView: ",e),e.currentAllocation&&(t=i.a.createElement(v,e.currentAllocation)),e.nextAllocation&&(n=i.a.createElement(h,e.nextAllocation)),i.a.createElement("div",{className:"RoomView"},i.a.createElement(S,Object.assign({time:e.time},e)),i.a.createElement(w,{roomStatus:e.roomStatus},i.a.createElement(A,{time:e.time}),i.a.createElement("div",{className:"Separator"}),i.a.createElement("div",{className:"RightSection"},t,n,i.a.createElement(C,{currentAllocation:e.currentAllocation,nextAllocation:e.nextAllocation,roomStatus:e.roomStatus,roomId:e.room.id,onFinishEarlyClick:e.onFinishEarlyClick,onExtendMeetingClick:e.onExtendMeetingClick,onConfirmMeetingClick:e.onConfirmMeetingClick,onAddMeetingClick:e.onAddMeetingClick}))),i.a.createElement(x,{onAdminClicked:e.onAdminClick}),i.a.createElement(N,{open:e.adminPanelOpen,onCloseClick:e.onPopupCloseClick},i.a.createElement(_,null)))},z=function e(t,n,o,a){Object(u.a)(this,e),this.title=t,this.roomId=n,this.from=o,this.to=a,this.id=void 0,this.confirmed=!1,this.by=void 0,this.attendees=void 0,this.agenda=void 0,this.id=g()},G=Object(I.c)({slice:"allocation",initialState:{entity:{},ids:[]},reducers:{addAllocation:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},finishEarly:function(e,t){e.entity[t.payload].to=Date.now()-6e4},extendMeeting:function(e,t){e.entity[t.payload.id].to+=t.payload.amount,e.entity[t.payload.id].confirmed=!0},confirmMeeting:function(e,t){e.entity[t.payload.id].confirmed=!0,e.entity[t.payload.id].from=Date.now()-6e4}}}),K=n(23);!function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.Broken="Broken"}(y||(y={}));var Q=Object(I.c)({slice:"equipment",initialState:[],reducers:{addEquipment:function(e,t){return[].concat(Object(K.a)(e),[t.payload])},setStatus:function(e,t){return e.filter(function(e){return e.roomId===t.payload.roomId&&e.type===t.payload.type})[0].status=t.payload.status,e},changeStatus:function(e,t){var n=e.filter(function(e){return e.roomId===t.payload.roomId&&e.type===t.payload.type})[0],o=y.Available;switch(n.status){case y.Available:o=y.Broken;break;case y.Broken:o=y.NotAvailable;break;case y.NotAvailable:o=y.Available}return n.status=o,e}}}),X=Object(I.c)({slice:"ui",initialState:{selectedRoomId:"",time:Date.now(),adminPanelOpen:!1},reducers:{setSelectedRoomId:function(e,t){return e.selectedRoomId=t.payload,e},setTime:function(e,t){return e.time=t.payload,e},showAdminPanel:function(e){return e.adminPanelOpen=!0,e},hideAdminPanel:function(e){return e.adminPanelOpen=!1,e}}}),Y=Object(r.b)(function(e,t){console.log("mapState: ",e);var n,a=R(e),i=P(e),c=q(e),l=U(e),r=(n=12e4,Object(I.b)([H,F,R],function(e,t,a){return e?e.confirmed?o.occupied:o.awaiting:t&&t.from-a<n?t.confirmed?o.occupied:o.awaiting:o.free}))(e);return{currentAllocation:D(e)[0],equipment:l,nextAllocation:F(e),room:c,roomStatus:r,time:a,adminPanelOpen:i}},function(e){return{onAdminClick:function(){e(X.actions.showAdminPanel())},onPopupCloseClick:function(){e(X.actions.hideAdminPanel())},onAddMeetingClick:function(t){e(G.actions.addAllocation(Object(p.a)({},new z("Ad hoc meeting",t,Date.now()-6e4,Date.now()+5e4),{confirmed:!0})))},onChangeStatusClick:function(t){e(Q.actions.changeStatus(t)),console.log("TODO change status. Ids need to be added to equipment")},onConfirmMeetingClick:function(t){e(G.actions.confirmMeeting({id:t}))},onExtendMeetingClick:function(t,n){e(G.actions.extendMeeting({id:t,amount:n}))},onFinishEarlyClick:function(t){e(G.actions.finishEarly(t))}}})($),Z=(n(59),function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return console.log("hello world","test"),i.a.createElement("div",{className:"App"},i.a.createElement(Y,null))}}]),t}(a.Component)),ee=(n(61),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function te(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var ne,oe=function e(t){Object(u.a)(this,e),this.name=t,this.id=void 0,this.capacity=void 0,this.location=void 0,this.equipment=void 0,this.id=g()},ae=n(3),ie=Object(ae.combineReducers)({ui:X.reducer,room:V.reducer,allocation:G.reducer,equipment:Q.reducer}),ce=Object(I.a)({reducer:ie}),le=function e(t,n,o){Object(u.a)(this,e),this.roomId=t,this.type=n,this.status=o};!function(e){e.Projector="display",e.WhiteBoard="users",e.Skype="skype"}(ne||(ne={}));(function(){console.log("hello world"),ce.subscribe(function(){console.log(ce.getState())});var e=new oe("Supernova");ce.dispatch(V.actions.addRoom(Object(p.a)({},e))),ce.dispatch(V.actions.addRoom(Object(p.a)({},new oe("Room 2")))),ce.dispatch(X.actions.setSelectedRoomId(e.id)),ce.dispatch(G.actions.addAllocation(Object(p.a)({},new z("Test allocation 2a","Room 2",Date.now()-12e5,Date.now()-12e5)))),ce.dispatch(Q.actions.addEquipment(Object(p.a)({},new le(e.id,ne.Projector,y.Available)))),ce.dispatch(Q.actions.addEquipment(Object(p.a)({},new le(e.id,ne.Skype,y.Available)))),ce.dispatch(Q.actions.addEquipment(Object(p.a)({},new le(e.id,ne.WhiteBoard,y.Available))));var t=M(ce.getState()),n=B(ce.getState()),o=U(ce.getState()),a=L(ce.getState()),i=D(ce.getState())[0],c=F(ce.getState());console.log("Name: ",t),console.log("Allocations: ",n),console.log("Occupied: ",a),console.log("Equipment: ",o),console.log("Current allocation: ",i),console.log("Next allocation: ",c),setInterval(function(){console.log("Interval"),ce.dispatch(X.actions.setTime(Date.now()))},6e4)})(),l.a.render(i.a.createElement(r.a,{store:ce},i.a.createElement(Z,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rosi",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/rosi","/service-worker.js");ee?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):te(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):te(t,e)})}}()}},[[24,2,1]]]);
//# sourceMappingURL=main.8a83a69a.chunk.js.map