(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n.p+"static/media/symbol-defs.119ddbe0.svg"},28:function(e,t,n){e.exports=n(71)},37:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){},63:function(e,t,n){},65:function(e,t,n){},67:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var i,o=n(0),a=n.n(o),c=n(24),l=n.n(c),r=n(8),s=n(3),u=n(5),d=n(9),m=n(7),g=n(10),f=n(2),p=function(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},h=function(e){return Math.ceil(e/1e3/60)},v=function(e){return e-e%6e4},y=function(e,t){return Object(f.a)({},e,t)},b=function(e,t){var n=!0;if(!t)return!0;if(t.required&&(n=""!==e.trim()&&n),t.minLength&&(n=e.length>=t.minLength&&n),t.maxLength&&(n=e.length<=t.maxLength&&n),t.isEmail){n=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)&&n}if(t.isNumeric){n=/^\d+$/.test(e)&&n}return n},E=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},C=(n(37),function(e){var t=h(e.from-e.time);return a.a.createElement("div",{className:"AllocationInfo"},a.a.createElement("div",null,"Next Meeting"),a.a.createElement("div",null,a.a.createElement("h4",null,e.title)),a.a.createElement("div",null,p(e.from)," - ",p(e.to)),a.a.createElement("div",null,"Starts In: ",Math.floor(t/60)?a.a.createElement("span",null,Math.floor(t/60)," h"):null," ",t%60," min"))}),k=(n(39),function(e){var t=h(e.to-e.time),n=h(e.to-e.from),i=n-t;Math.round(i/n*100);return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"AllocationInfoBig"},a.a.createElement("div",null,"In Progress"),a.a.createElement("div",null,a.a.createElement("h2",null,e.title)),a.a.createElement("div",null,a.a.createElement("span",null,p(e.from)," - ",p(e.to))),a.a.createElement("div",null,"Ends In: ",Math.floor(t/60)?a.a.createElement("span",null,Math.floor(t/60)," h"):null," ",t%60," min"),e.attendees?a.a.createElement("div",null,e.attendees," attendees"):null,e.agenda?a.a.createElement("div",null,"Agenda: ",e.agenda):null))});!function(e){e.occupied="occupied",e.free="free",e.awaiting="awaiting"}(i||(i={}));n(41);var I,S,O=n(20),j=n.n(O),x=function(e){var t=a.a.createElement("button",null,"Not configured button");switch(e.type){case"icon":t=a.a.createElement("button",{className:"btn ".concat(e.btnClassName),onClick:e.onClick,"aria-label":e.iconId},a.a.createElement("svg",{className:"icon"},a.a.createElement("use",{xlinkHref:"".concat(j.a,"#").concat(e.iconId)})));break;case"icon-text":t=a.a.createElement("button",{className:"btn btn_flat",onClick:e.onClick,"aria-label":e.label},a.a.createElement("svg",{className:"icon"},a.a.createElement("use",{xlinkHref:"".concat(j.a,"#").concat(e.iconId)})),a.a.createElement("span",null,e.label));break;case"text":t=a.a.createElement("button",{type:"button",className:"btn btn_flat",onClick:e.onClick,"aria-label":e.label},a.a.createElement("span",null,e.label))}return t},A=function(e){var t,n,o;e.currentAllocation?(e.roomStatus===i.awaiting&&(n=a.a.createElement(x,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.currentAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=a.a.createElement(a.a.Fragment,null,a.a.createElement(x,{type:"icon-text",onClick:function(){return e.onExtendMeetingClick(e.currentAllocation.id,e.time,9e5)},iconId:"icon-calendar-plus-o",label:"Extend"}),a.a.createElement(x,{type:"icon-text",onClick:function(){return e.onFinishEarlyClick(e.currentAllocation.id,e.time)},iconId:"icon-calendar-times-o",label:"Finish"}),n)):(e.roomStatus===i.awaiting&&(o=a.a.createElement(x,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.nextAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=a.a.createElement(a.a.Fragment,null,a.a.createElement(x,{type:"icon-text",onClick:function(){return e.onAddMeetingClick(e.roomId,e.time)},iconId:"icon-calendar-o",label:"Book now"}),o));return a.a.createElement("div",{className:"AllocationMenu ".concat(e.roomStatus)},t)},w=(n(43),function(e){var t=["RoomStatusBorder"];return t.push(e.roomStatus),a.a.createElement("div",{className:t.join(" ")},e.children)}),N=(n(45),function(e){return a.a.createElement("div",{className:"StatusBar"},a.a.createElement(x,{type:"icon-text",onClick:e.onAdminClicked,iconId:"icon-settings",label:"Admin"}))}),D=(n(47),function(e){var t=240,n=500,i="#4CAF50",o="#F44336";function c(e,i,o,a,c,l){var r=c||t;function s(e){var t=2*Math.PI/720;return-.5*Math.PI+e*t}e.beginPath(),e.lineWidth=l||4,e.strokeStyle=a;var u=s(i),d=s(o);e.arc(n/2,n/2,r,u,d),e.stroke()}function l(e){var t=new Date(0);return t.setUTCMilliseconds(e),60*t.getHours()+t.getMinutes()}var r=a.a.createRef();return setTimeout(function(){if(r.current&&r.current.getContext){var t=r.current.getContext("2d");r.current.width=n,r.current.height=n,function(t){var n=l(e.time);c(t,n+1,n,"#000",200,22),c(t,n-60,n-120,i,203,5),e.allocations.map(function(e){return{from:l(e.from),to:l(e.to)}}).forEach(function(e){return c(t,e.from,e.to,o,200,12)}),c(t,n-2,n+3,"#FFF",170,30),c(t,n,n+1,"#000",196,20);for(var a=0;a<24;a++)a%2?c(t,30*a,30*a+1,"#FFF",200,12):c(t,30*a,30*a+1,"#FFF",196,20)}(t)}},10),a.a.createElement("div",{className:"TimeView"},a.a.createElement("span",null,p(e.time)),a.a.createElement("canvas",{className:"TimeViewCanvas",id:"canvas",ref:r}))}),T=(n(49),n(51),function(e){return a.a.createElement("div",{className:"EquipmentBar"},e.equipment.map(function(t){return function(t){return a.a.createElement(x,{key:t.type,type:"icon",onClick:function(){return e.onChangeStatusClick(t)},iconId:"icon-".concat(t.type.toLowerCase()),btnClassName:"btn_".concat(t.status.toLowerCase())})}(t)}))}),F=(n(53),function(e){return a.a.createElement("div",{className:"Header"},a.a.createElement("div",null,a.a.createElement("h1",null,e.room.name)),a.a.createElement("div",null,(new Date).toLocaleDateString()),a.a.createElement(T,{equipment:e.equipment,onChangeStatusClick:e.onChangeStatusClick}))}),P=(n(55),n(57),function(){return a.a.createElement("div",{className:"Backdrop"})}),R=function(e){var t=["Popup"];return e.open&&t.push("open"),a.a.createElement("div",{className:t.join(" ")},a.a.createElement(P,null),a.a.createElement("div",{className:"content"},a.a.createElement(x,{type:"icon-text",onClick:e.onCloseClick,iconId:"icon-close",label:"Close"}),e.children))},q=n(1),M=Object(q.c)(["ui.time"]),L=Object(q.c)(["ui.selectedRoomId"]),B=Object(q.c)(["ui.adminPanelOpen"]),K=Object(q.c)(["ui.syncSettings"]),U=Object(q.c)([L,"room"],function(e,t){return t.entity[e]}),z=Object(q.c)([L,"allocation"],function(e,t){return Object.values(t.entity).filter(function(t){return t.roomId===e})}),G=Object(q.c)([M,z],function(e,t){return t.filter(function(t){return t.from<=e&&t.to>=e})}),V=Object(q.c)([M,z],function(e,t){return t.filter(function(t){return t.from>=e})}),W=Object(q.c)([V],function(e){return e.sort(function(e,t){return e.from-t.from})}),_=Object(q.c)([(I=1,Object(q.c)([W],function(e){return e.slice(0,I)}))],function(e){return e[0]}),H=(Object(q.c)([_,M],function(e,t){return e.from-t}),Object(q.c)([G],function(e){return e[0]})),$=(Object(q.c)([H],function(e){return e.to-e.from}),Object(q.c)([G,M],function(e,t){return e.to-t}),Object(q.c)([G],function(e){return e.length>0}),Object(q.c)([L,"equipment"],function(e,t){return t.entity?(Object.values(t.entity)||[]).filter(function(t){return t.roomId===e}):[]})),J=Object(q.d)({slice:"room",initialState:{entity:{},ids:[]},reducers:{addRoom:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},changeRoomName:function(e,t){e.entity[t.payload.id]?e.entity[t.payload.id].name=t.payload.name:(e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id))}}}),Y=n(13),Q=n.n(Y),X=Object(q.b)("crossslice/savestate/started"),Z=Object(q.b)("crossslice/savestate/succeeded"),ee=Object(q.b)("crossslice/savestate/failed"),te=Object(q.b)("crossslice/loadstate/started"),ne=Object(q.b)("crossslice/loadstate/succeeded"),ie=Object(q.b)("crossslice/loadstate/failed"),oe=Object(q.b)("crossslice/removestate/started"),ae=Object(q.b)("crossslice/removestate/succeeded"),ce=Object(q.b)("crossslice/removestate/failed"),le=function(){return function(e,t){return e(X()),(n="state",i=t(),Q.a.setItem(n,i)).then(function(){return e(Z())},function(t){return e(ee(t))});var n,i}},re=function(){return function(e){return e(te()),(t="state",Q.a.getItem(t)).then(function(t){return e(ne(t))},function(t){return e(ie(t))});var t}},se=function(){return function(e){return e(oe()),(t="state",Q.a.removeItem(t)).then(function(t){e(ae(t)),e(re())},function(t){return e(ce(t))});var t}},ue=Object(q.d)({slice:"ui",initialState:{selectedRoomId:"",time:Date.now(),adminPanelOpen:!1,syncSettings:{},syncInProgress:!1,syncError:""},reducers:{setSelectedRoomId:function(e,t){return e.selectedRoomId=t.payload,e},setTime:function(e,t){return e.time=t.payload,e},showAdminPanel:function(e){return e.adminPanelOpen=!0,e},hideAdminPanel:function(e){return e.adminPanelOpen=!1,e},setSyncSettings:function(e,t){return e.syncSettings=t.payload,e}}}),de=n(15),me=function e(t){Object(s.a)(this,e),this.name=t,this.id=void 0,this.capacity=void 0,this.location=void 0,this.equipment=void 0,this.id=E()};!function(e){e.Projector="display",e.WhiteBoard="users",e.Skype="skype"}(S||(S={}));var ge,fe=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,"This is equipment admin"),Object.values(S).map(function(t){return a.a.createElement("div",{key:t},a.a.createElement("button",{onClick:function(){return e.onEquipmentToggleClick(e.roomId,t)}},t))}))},pe=(n(63),function(e){var t=null,n=["InputElement"];switch(e.invalid&&e.shouldValidate&&e.touched&&n.push("Invalid"),e.elementType){case"input":t=a.a.createElement("input",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"textarea":t=a.a.createElement("textarea",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"select":t=a.a.createElement("select",{className:n.join(" "),value:e.value,onChange:e.changed},e.elementConfig.options.map(function(e){return a.a.createElement("option",{key:e.value,value:e.value},e.displayValue)}));break;default:t=a.a.createElement("input",Object.assign({className:n.join(" ")},e.elementConfig,{value:e.value,onChange:e.changed}))}return a.a.createElement("div",{className:"Input"},a.a.createElement("label",{className:"Label"},e.label),t)}),he=(n(65),n(12)),ve=function(e){function t(e){var n;return Object(s.a)(this,t),console.log("[SignInButton] constructor"),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).apiCalendar=void 0,n.apiCalendar=n.props.googleApi,n.state={signedIn:n.apiCalendar.sign},n.handleItemClick=n.handleItemClick.bind(Object(he.a)(Object(he.a)(n))),n.apiCalendar.onLoadCallback=function(){n.setState({signedIn:n.apiCalendar.sign}),n.apiCalendar.listenSign(function(e){console.log(e),n.setState({signedIn:e})})},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){console.log("[SignInButton] componentDidMount")}},{key:"handleItemClick",value:function(e,t){"sign-in"===t?this.apiCalendar.handleAuthClick():"sign-out"===t&&this.apiCalendar.handleSignoutClick()}},{key:"sync",value:function(){var e=this;setInterval(function(){console.log("[SignIn button] syncing events in interval"),e.apiCalendar.listUpcomingEvents()},6e4)}},{key:"initClient",value:function(){this.apiCalendar.initClient()}},{key:"render",value:function(){var e=this,t=this.state.signedIn?a.a.createElement("button",{onClick:function(t){return e.handleItemClick(t,"sign-out")}},"sign-out"):a.a.createElement("button",{onClick:function(t){return e.handleItemClick(t,"sign-in")}},"sign-in");return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{onClick:function(){return e.initClient()}},"init client"),t,a.a.createElement("button",{onClick:function(){return e.sync()}},"sync"))}}]),t}(a.a.Component),ye=function e(t,n,i,o){Object(s.a)(this,e),this.title=t,this.roomId=n,this.from=i,this.to=o,this.id=void 0,this.confirmed=!1,this.by=void 0,this.attendees=void 0,this.agenda=void 0,this.extId=void 0,this.extStatus=void 0,this.id=E(),this.from=v(this.from),this.to=v(this.to)},be=Object(q.d)({slice:"allocation",initialState:{entity:{},ids:[]},reducers:{addAllocation:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},deleteAllocation:function(e,t){delete e.entity[t.payload.id],e.ids=e.ids.filter(function(e){return e!==t.payload.id})},finishEarly:function(e,t){e.entity[t.payload].to=v(t.payload.time),e.entity[t.payload].confirmed=!0},extendMeeting:function(e,t){e.entity[t.payload.id].to+=t.payload.amount,e.entity[t.payload.id].confirmed=!0},confirmMeeting:function(e,t){e.entity[t.payload.id].confirmed=!0,e.entity[t.payload.id].from=v(t.payload.time)},syncExternalAllocations:function(e,t){console.log("[AllocationSlice:syncExternalAllocations] : ",t);var n=t.payload,i=Object.values(e.entity).filter(function(e){return!!e.extId&&!e.confirmed&&!n.find(function(t){return t.extId===e.extId})}),o=!0,a=!1,c=void 0;try{for(var l,r=function(){var t=l.value;delete e.entity[t.id],e.ids=e.ids.filter(function(e){return e!==t.id})},s=i[Symbol.iterator]();!(o=(l=s.next()).done);o=!0)r()}catch(h){a=!0,c=h}finally{try{o||null==s.return||s.return()}finally{if(a)throw c}}var u=!0,d=!1,m=void 0;try{for(var g,f=function(){var t=g.value,n=Object.values(e.entity).find(function(e){return e.extId===t.extId});n?"confirmed"!==t.extStatus?(delete e.entity[n.id],e.ids=e.ids.filter(function(e){return e!==n.id})):n.confirmed||(n.from=t.from,n.to=t.to,n.title=t.title):"confirmed"===t.extStatus&&(e.entity[t.id]=t,e.ids.push(t.id))},p=n[Symbol.iterator]();!(u=(g=p.next()).done);u=!0)f()}catch(h){d=!0,m=h}finally{try{u||null==p.return||p.return()}finally{if(d)throw m}}}}}),Ee=n(4),Ce=function e(t,n,i){Object(s.a)(this,e),this.roomId=t,this.type=n,this.status=i,this.id=void 0,this.id=E()};!function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.Broken="Broken"}(ge||(ge={}));var ke=Object(q.d)({slice:"equipment",initialState:{entity:{}},reducers:{addEquipment:function(e,t){e.entity[t.payload.id]=t.payload},deleteEquipment:function(e,t){delete e.entity[t.payload.id]},toggleEquipment:function(e,t){console.log("toggle equipment: ",t);var n=t.payload.roomId,i=t.payload.type,o=Object.values(e.entity).filter(function(e){return e.roomId===n&&e.type===i})[0];if(o)delete e.entity[o.id];else{var a=new Ce(n,i,ge.Available);e.entity[a.id]=Object(f.a)({},a)}},setStatus:function(e,t){return e.entity[t.payload.id].status=t.payload.status,e},changeStatus:function(e,t){var n=e.entity[t.payload.id],i=ge.Available;switch(n.status){case ge.Available:i=ge.Broken;break;case ge.Broken:i=ge.NotAvailable;break;case ge.NotAvailable:i=ge.Available}return n.status=i,e}}}),Ie=n(27),Se=Object(Ee.combineReducers)({ui:ue.reducer,room:J.reducer,allocation:be.reducer,equipment:ke.reducer}),Oe=Object(Ie.a)(Se,function(e,t){var n=Object(f.a)({},e);switch(n.ui=Object(f.a)({},n.ui),t.type){case oe.toString():return n.ui.syncInProgress=!0,n;case ae.toString():return n.ui.syncInProgress=!1,n;case ce.toString():return n.ui.syncInProgress=!1,n.ui.syncError=t.payload,n;case X.toString():return n.ui.syncInProgress=!0,n;case Z.toString():return n.ui.syncInProgress=!1,n;case ee.toString():return n.ui.syncInProgress=!1,n.ui.syncError=t.payload,n;case te.toString():return n.ui.syncInProgress=!0,n;case ne.toString():return(n=Object(f.a)({},n,t.payload)).ui.time=Date.now(),n.ui.syncInProgress=!1,n;case ie.toString():return n.ui.syncInProgress=!1,n.ui.syncError=t.payload,n;default:return e}}),je=Object(q.a)({reducer:Oe}),xe=function(){function e(t,n,i,o){Object(s.a)(this,e),this.sign=!1,this.onLoadCallback=void 0,this.events={},this.syncToken=null,this.DISCOVERY_DOCS=["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],this.SCOPES="https://www.googleapis.com/auth/calendar.readonly",this.CONFIG={apiKey:"[googleApi] apiKey not provided!!",clientId:"[googleApi] clientId not provided!!",discoveryDocs:this.DISCOVERY_DOCS,scope:this.SCOPES},this.calendarId=void 0,this.roomId=void 0,this.roomId=t,this.calendarId=o,this.CONFIG.apiKey=n,this.CONFIG.clientId=i,this.handleClientLoad()}return Object(u.a)(e,[{key:"gapi",get:function(){return window.gapi}}]),Object(u.a)(e,[{key:"changeConfig",value:function(e,t,n,i){this.roomId=e,this.calendarId=i,this.CONFIG.apiKey=t,this.CONFIG.clientId=n}},{key:"handleClientLoad",value:function(){var e=this,t=document.createElement("script");t.src="https://apis.google.com/js/api.js",document.body.appendChild(t),t.onload=function(){e.gapi.load("client:auth2",function(){return console.log("[Google Api] gapi loaded")})}}},{key:"handleAuthClick",value:function(){this.gapi?this.gapi.auth2.getAuthInstance().signIn():console.log("Error: this.gapi not loaded")}},{key:"handleSignoutClick",value:function(){this.gapi?this.gapi.auth2.getAuthInstance().signOut():console.log("Error: this.gapi not loaded")}},{key:"listenSign",value:function(e){this.gapi?this.gapi.auth2.getAuthInstance().isSignedIn.listen(e):console.log("Error: this.gapi not loaded")}},{key:"sync",value:function(){var e,t=this;null==this.syncToken?(console.log("Performing full sync."),e=this.constructUpcomingEventsRequestFull()):(console.log("Performing incremental sync."),(e=this.constructUpcomingEventsRequestPartial()).syncToken=this.syncToken);!function n(i){e.pageToken=i,console.log("request body: ",e),t.gapi.client.calendar.events.list(e).then(function(e){console.log("synced object: ",e.result),console.log("events synced: ",e.result.items),t.events=e.result,0===t.events.items.length?console.log("No new events to sync."):(console.log("[TODO] syncEvents"),t.syncEvents(t.events.items));var i=t.events.nextPageToken;i?(console.log("new pageToken: ",i),n(i)):(console.log("setting sync Token: ",t.events.nextSyncToken),t.syncToken=t.events.nextSyncToken,console.log("Sync complete."))}).catch(function(e){if(console.log("Sync Error: ",e),410!==e.statusCode)throw e;console.log("Invalid sync token, clearing event store and re-syncing."),t.syncToken=null,t.events=[],t.sync()})}(null)}},{key:"syncEvents",value:function(e){var t=this,n=e.map(function(e){var n=new ye(e.summary,t.roomId,new Date(e.start.dateTime).getTime(),new Date(e.end.dateTime).getTime());return e.attendees&&(n.attendees=e.attendees.length),e.organizer&&e.organizer.displayName&&(n.by=e.organizer.displayName),n.extId=e.id,n.extStatus=e.status,Object(f.a)({},n)});je.dispatch(be.actions.syncExternalAllocations(n)),console.log("Google api. syncEvents items: ",e.length)}},{key:"listUpcomingEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(console.log("[GoogleApi] list upcoming events"),this.gapi){var n=new Date,i=new Date;return i.setDate(n.getDate()+1),this.gapi.client.calendar.events.list({calendarId:this.calendarId,maxResults:t,orderBy:"startTime",showDeleted:!0,singleEvents:!0,timeMin:n.toISOString(),timeMax:i.toISOString()}).then(function(t){console.log("events: ",t.result.items),e.syncEvents(t.result.items)})}return console.log("Error: this.gapi not loaded"),!1}},{key:"constructUpcomingEventsRequestFull",value:function(){return{calendarId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.calendarId,maxResults:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,pageToken:null,singleEvents:!0,syncToken:null,timeMin:(new Date).toISOString()}}},{key:"constructUpcomingEventsRequestPartial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.calendarId,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=new Date;return(new Date).setDate(n.getDate()+1),{calendarId:e,maxResults:t,pageToken:null,singleEvents:!0,syncToken:null}}},{key:"initClient",value:function(){var e=this;this.gapi.client.init(this.CONFIG).then(function(){console.log("[Google API] Client init success"),e.gapi.auth2.getAuthInstance().isSignedIn.listen(function(t){return e.updateSigninStatus(t)}),e.updateSigninStatus(e.gapi.auth2.getAuthInstance().isSignedIn.get()),e.onLoadCallback&&e.onLoadCallback()}).catch(function(e){console.log("[Google API] Client init error:",e)})}},{key:"updateSigninStatus",value:function(e){e&&this.listUpcomingEvents(10),this.sign=e}}]),e}(),Ae=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={orderForm:{roomName:{elementType:"input",elementConfig:{type:"text",placeholder:"Room name"},value:"",validation:{required:!0},valid:!1,touched:!1},clientID:{elementType:"input",elementConfig:{type:"text",placeholder:"Client ID"},value:"",validation:{required:!0},valid:!1,touched:!1},apiKey:{elementType:"input",elementConfig:{type:"text",placeholder:"API key"},value:"",validation:{required:!0},valid:!1,touched:!1},calendarID:{elementType:"input",elementConfig:{type:"text",placeholder:"Calendar ID"},value:"",validation:{required:!0},valid:!1,touched:!1}},formIsValid:!1},n.selectedRoom=void 0,n.roomEquipment=void 0,n.syncSettings=void 0,n.googleApi=void 0,n.submitSettings=function(e){e.preventDefault();var t={};for(var i in n.state.orderForm)t[i]=n.state.orderForm[i].value;n.selectedRoom.name=t.roomName;var o={syncSettings:{clientID:t.clientID,apiKey:t.apiKey,calendarID:t.calendarID},room:n.selectedRoom};console.log("[AdminPanel] selectedroom:",n.selectedRoom),console.log("[AdminPanel] settings: ",o),n.props.onSettingsSaved(o),n.googleApi.changeConfig(o.room.id,o.syncSettings.apiKey,o.syncSettings.clientID,o.syncSettings.calendarID)},n.inputChangedHandler=function(e,t){var i=y(n.state.orderForm[t],{value:e.target.value,valid:b(e.target.value,n.state.orderForm[t].validation),touched:!0}),o=y(n.state.orderForm,Object(de.a)({},t,i)),a=!0;for(var c in o)a=o[c].valid&&a;n.setSyncSettings(o),n.setState({orderForm:o,formIsValid:a})},n.selectedRoom=Object(f.a)({},e.selectedRoom),n.roomEquipment=Object(f.a)({},e.roomEquipment),n.syncSettings=Object(f.a)({},e.syncSettings),n.selectedRoom||(n.selectedRoom=Object(f.a)({},new me("Conference Room 1"))),n.state.orderForm.roomName.value=n.selectedRoom.name,n.state.orderForm.clientID.value=n.syncSettings.clientID,n.state.orderForm.apiKey.value=n.syncSettings.apiKey,n.state.orderForm.calendarID.value=n.syncSettings.calendarID,n.googleApi=new xe(n.selectedRoom.id,n.syncSettings.apiKey,n.syncSettings.clientID,n.syncSettings.calendarID),n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"setSyncSettings",value:function(e){this.syncSettings={clientID:e.clientID,apiKey:e.apiKey,calendarID:e.calendarID}}},{key:"clearSettings",value:function(){this.props.onSettingsClear()}},{key:"render",value:function(){var e=this,t=[];for(var n in this.state.orderForm)t.push({id:n,config:this.state.orderForm[n]});var i=a.a.createElement("form",{onSubmit:this.submitSettings},t.map(function(t){return a.a.createElement(pe,{key:t.id,elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,invalid:!t.config.valid,shouldValidate:t.config.validation,touched:t.config.touched,changed:function(n){return e.inputChangedHandler(n,t.id)}})}),a.a.createElement("div",null,a.a.createElement(fe,{roomId:this.selectedRoom.id,equipment:this.roomEquipment,onEquipmentToggleClick:this.props.onEquipmentToggleClick})),a.a.createElement(ve,{roomId:this.selectedRoom.id,googleApi:this.googleApi}),a.a.createElement(x,{type:"icon-text",iconId:"icon-save",label:"Save Settings"}));return a.a.createElement("div",{className:"ContactData"},a.a.createElement("h4",null,"Enter your Contact Data"),i,a.a.createElement(x,{type:"text",label:"Clear Settings",onClick:function(){return e.clearSettings()}}))}}]),t}(o.Component),we=Object(r.b)(function(e){return{selectedRoom:U(e),roomEquipment:$(e),syncSettings:K(e)}},function(e){return{onSettingsSaved:function(t){e(J.actions.changeRoomName(Object(f.a)({},t.room))),e(ue.actions.setSelectedRoomId(t.room.id)),e(ue.actions.setSyncSettings(t.syncSettings)),e(le())},onEquipmentToggleClick:function(t,n){console.log("onEquipmentToggleClick"),e(ke.actions.toggleEquipment({roomId:t,type:n}))},onSettingsClear:function(){e(se())}}})(Ae),Ne=function(e){return e.room?(e.currentAllocation&&(t=a.a.createElement(k,Object.assign({time:e.time},e.currentAllocation))),e.nextAllocation&&(n=a.a.createElement(C,Object.assign({time:e.time},e.nextAllocation))),a.a.createElement("div",{className:"RoomView"},a.a.createElement(w,{roomStatus:e.roomStatus},a.a.createElement(F,Object.assign({time:e.time},e))),a.a.createElement("div",{className:"Content"},a.a.createElement(D,{time:e.time,allocations:e.clockAllocations}),a.a.createElement("div",{className:"Separator"}),a.a.createElement("div",{className:"RightSection"},a.a.createElement("div",{className:"Allocations"},t,n),a.a.createElement(A,{roomId:e.room.id,time:e.time,currentAllocation:e.currentAllocation,nextAllocation:e.nextAllocation,roomStatus:e.roomStatus,onFinishEarlyClick:e.onFinishEarlyClick,onExtendMeetingClick:e.onExtendMeetingClick,onConfirmMeetingClick:e.onConfirmMeetingClick,onAddMeetingClick:e.onAddMeetingClick}))),a.a.createElement(w,{roomStatus:e.roomStatus},a.a.createElement(N,{room:e.room,onAdminClicked:e.onAdminClick})),a.a.createElement(R,{open:e.adminPanelOpen,onCloseClick:e.onPopupCloseClick},a.a.createElement(we,null)))):(console.error("[RoomView] No room provided!"),a.a.createElement(we,null));var t,n},De=Object(r.b)(function(e,t){var n,o,a,c=M(e),l=B(e),r=U(e),s=$(e),u=(n=12e4,Object(q.c)([H,_,M],function(e,t,o){return e?e.confirmed?i.occupied:i.awaiting:t&&t.from-o<n?t.confirmed?i.occupied:i.awaiting:i.free}))(e);return{currentAllocation:H(e),equipment:s,nextAllocation:_(e),room:r,roomStatus:u,time:c,adminPanelOpen:l,clockAllocations:(o=c-36e5,a=c+36e6,Object(q.c)([z],function(e){return e.filter(function(e){return e.to>o&&e.to<a})}))(e)}},function(e){return{onAdminClick:function(){e(ue.actions.showAdminPanel())},onPopupCloseClick:function(){e(ue.actions.hideAdminPanel())},onAddMeetingClick:function(t,n){e(be.actions.addAllocation(Object(f.a)({},new ye("Ad hoc meeting",t,n,n+18e5),{confirmed:!0})))},onChangeStatusClick:function(t){e(ke.actions.changeStatus(t)),console.log("TODO change status. Ids need to be added to equipment")},onConfirmMeetingClick:function(t){e(be.actions.confirmMeeting({id:t}))},onExtendMeetingClick:function(t,n,i){e(be.actions.extendMeeting({id:t,time:n,amount:i}))},onFinishEarlyClick:function(t,n){e(be.actions.finishEarly(t,n))}}})(Ne),Te=(n(67),function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(De,null))}}]),t}(o.Component)),Fe=(n(69),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Pe(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}(function(){var e=je.getState();console.log("[Start] startState:",e),je.dispatch(re()),setInterval(function(){console.log("[Start] Interval"),je.dispatch(ue.actions.setTime(v(Date.now())+1)),je.dispatch(le())},6e4)})(),l.a.render(a.a.createElement(r.a,{store:je},a.a.createElement(Te,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rosi",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/rosi","/service-worker.js");Fe?(function(e,t){fetch(e).then(function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Pe(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Pe(t,e)})}}()}},[[28,2,1]]]);
//# sourceMappingURL=main.c15d3c98.chunk.js.map