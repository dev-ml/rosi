(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,n,t){e.exports=t(65)},35:function(e,n,t){},37:function(e,n,t){},39:function(e,n,t){},41:function(e,n,t){},43:function(e,n,t){},45:function(e,n,t){},47:function(e,n,t){},49:function(e,n,t){},51:function(e,n,t){},53:function(e,n,t){},55:function(e,n,t){},61:function(e,n,t){},63:function(e,n,t){},65:function(e,n,t){"use strict";t.r(n);var o,a=t(0),i=t.n(a),c=t(21),r=t.n(c),l=t(5),u=t(4),s=t(10),d=t(12),m=t(11),f=t(13),p=t(6),g=function(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},b=(t(35),function(e){return console.log("allocationInfo: ",e),i.a.createElement("div",{className:"AllocationInfo"},"Next Meeting:",i.a.createElement("div",null,g(e.from)," - ",g(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title))}),v=(t(37),function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"AllocationInfoBig"},"Current Meeting:",i.a.createElement("div",null,g(e.from)," - ",g(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title),e.attendees?i.a.createElement("div",null,"Attendees: ",e.attendees):null,e.agenda?i.a.createElement("div",null,"Agenda: ",e.agenda):null))});!function(e){e.occupied="occupied",e.free="free",e.awaiting="awaiting"}(o||(o={}));t(39);var h,y,E=function(e){var n=i.a.createElement("button",null,"Not configured button");switch(e.type){case"icon":n=i.a.createElement("button",{className:"btn ".concat(e.btnClassName),onClick:e.onClick,"aria-label":e.iconId},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})));break;case"icon-text":n=i.a.createElement("button",{className:"btn btn_flat",onClick:e.onClick,"aria-label":e.label},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})),i.a.createElement("span",null,e.label))}return n},C=function(e){var n,t,a;console.log("Allocation menu:",e.id),console.log("Props: ",e),e.currentAllocation?(e.roomStatus===o.awaiting&&(t=i.a.createElement(E,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.currentAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),n=i.a.createElement(i.a.Fragment,null,i.a.createElement(E,{type:"icon-text",onClick:function(){return e.onExtendMeetingClick(e.currentAllocation.id,6e4)},iconId:"icon-calendar-plus-o",label:"Extend"}),i.a.createElement(E,{type:"icon-text",onClick:function(){return e.onFinishEarlyClick(e.currentAllocation.id)},iconId:"icon-calendar-times-o",label:"Finish"}),t)):(e.roomStatus===o.awaiting&&(a=i.a.createElement(E,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.nextAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),n=i.a.createElement(i.a.Fragment,null,i.a.createElement(E,{type:"icon-text",onClick:function(){return e.onAddMeetingClick(e.roomId)},iconId:"icon-calendar-o",label:"Book now"}),a));return i.a.createElement("div",{className:"AllocationMenu ".concat(e.roomStatus)},n)},k=(t(41),function(e){var n=["RoomStatusBorder"];return n.push(e.roomStatus),i.a.createElement("div",{className:n.join(" ")},e.children)}),x=(t(43),function(e){return i.a.createElement("div",{className:"StatusBar"},i.a.createElement("div",null,"This is StatusBar"),i.a.createElement(E,{type:"icon-text",onClick:e.onAdminClicked,iconId:"icon-settings",label:"Admin"}))}),O=(t(45),function(e){return i.a.createElement("div",{className:"TimeView"},g(e.time))}),w=(t(47),t(49),function(e){return i.a.createElement("div",{className:"EquipmentBar"},e.equipment.map(function(n){return function(n){return i.a.createElement(E,{key:n.type,type:"icon",onClick:function(){return e.onChangeStatusClick(n)},iconId:"icon-".concat(n.type.toLowerCase()),btnClassName:"btn_".concat(n.status.toLowerCase())})}(n)}))}),A=(t(51),function(e){return i.a.createElement("div",{className:"Header"},i.a.createElement("div",null,e.room.name),i.a.createElement(w,{equipment:e.equipment,onChangeStatusClick:e.onChangeStatusClick}))}),j=(t(53),t(55),function(){return i.a.createElement("div",{className:"Backdrop"})}),S=function(e){var n=["Popup"];return e.open&&n.push("open"),i.a.createElement("div",{className:n.join(" ")},i.a.createElement(j,null),i.a.createElement("div",{className:"content"},i.a.createElement(E,{type:"icon-text",onClick:e.onCloseClick,iconId:"icon-close",label:"Close"}),e.children))},I=t(1),N=Object(I.c)(["ui.time"]),P=Object(I.c)(["ui.selectedRoomId"]),R=Object(I.c)(["ui.adminPanelOpen"]),M=Object(I.c)([P,"room"],function(e,n){return n.entity[e]}),B=Object(I.c)([P,"allocation"],function(e,n){return Object.values(n.entity).filter(function(n){return n.roomId===e})}),q=Object(I.c)([N,B],function(e,n){return n.filter(function(n){return n.from<=e&&n.to>=e})}),D=Object(I.c)([N,B],function(e,n){return n.filter(function(n){return n.from>=e})}),T=Object(I.c)([D],function(e){return e.sort(function(e,n){return e.from-n.from})}),F=Object(I.c)([(h=1,Object(I.c)([T],function(e){return e.slice(0,h)}))],function(e){return e[0]}),W=Object(I.c)([q],function(e){return e[0]}),H=(Object(I.c)([q],function(e){return e.length>0}),Object(I.c)([P,"equipment"],function(e,n){return n.filter(function(n){return n.roomId===e})})),L=Object(I.d)({slice:"room",initialState:{entity:{},ids:[]},reducers:{addRoom:function(e,n){e.entity[n.payload.id]=n.payload,e.ids.push(n.payload.id)},changeRoomName:function(e,n){e.entity[n.payload.id].name=n.payload.name}}}),U=t(8),V=t.n(U),J=Object(I.b)("crossslice/savestate/started"),_=Object(I.b)("crossslice/savestate/succeeded"),$=Object(I.b)("crossslice/savestate/failed"),z=Object(I.b)("crossslice/loadstate/started"),G=Object(I.b)("crossslice/loadstate/succeeded"),K=Object(I.b)("crossslice/loadstate/failed"),Q=function(){return function(e,n){return e(J()),(t="state",o=n(),V.a.setItem(t,o)).then(function(){return e(_())},function(n){return e($(n))});var t,o}},X=function(){return function(e){return e(z()),(n="state",V.a.getItem(n)).then(function(n){return e(G(n))},function(n){return e(K(n))});var n}},Y=function(e){function n(e){var t;return Object(u.a)(this,n),(t=Object(d.a)(this,Object(m.a)(n).call(this,e))).selectedRoom=void 0,console.log("!!props",e),t.selectedRoom=e.selectedRoom,t.state={roomName:t.selectedRoom.name},t}return Object(f.a)(n,e),Object(s.a)(n,[{key:"submitSettings",value:function(e){e.preventDefault(),console.log(e),this.props.onSettingsSaved(this.selectedRoom.id,this.state.roomName)}},{key:"inputChangedHandler",value:function(e){console.log(e),this.setState({roomName:e.target.value})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("h3",null,"This is admin panel"),i.a.createElement("form",{onSubmit:function(n){return e.submitSettings(n)}},i.a.createElement("div",null,i.a.createElement("label",null,"Room name"),i.a.createElement("input",{type:"text",placeholder:"Room Name",value:this.state.roomName,onChange:function(n){return e.inputChangedHandler(n)}})),i.a.createElement(E,{type:"icon-text",iconId:"icon-save",label:"Save Settings"})))}}]),n}(a.Component),Z=Object(l.b)(function(e){return{selectedRoom:M(e)}},function(e){return{onSettingsSaved:function(n,t){e(L.actions.changeRoomName({id:n,name:t})),e(Q())}}})(Y),ee=function(e){return console.log("roomView: ",e),e.room?(e.currentAllocation&&(n=i.a.createElement(v,e.currentAllocation)),e.nextAllocation&&(t=i.a.createElement(b,e.nextAllocation)),i.a.createElement("div",{className:"RoomView"},i.a.createElement(A,Object.assign({time:e.time},e)),i.a.createElement(k,{roomStatus:e.roomStatus},i.a.createElement(O,{time:e.time}),i.a.createElement("div",{className:"Separator"}),i.a.createElement("div",{className:"RightSection"},i.a.createElement("div",{className:"Allocations"},n,t),i.a.createElement(C,{currentAllocation:e.currentAllocation,nextAllocation:e.nextAllocation,roomStatus:e.roomStatus,roomId:e.room.id,onFinishEarlyClick:e.onFinishEarlyClick,onExtendMeetingClick:e.onExtendMeetingClick,onConfirmMeetingClick:e.onConfirmMeetingClick,onAddMeetingClick:e.onAddMeetingClick}))),i.a.createElement(x,{onAdminClicked:e.onAdminClick}),i.a.createElement(S,{open:e.adminPanelOpen,onCloseClick:e.onPopupCloseClick},i.a.createElement(Z,null)))):(console.error("[RoomView] No room provided!"),i.a.createElement("p",null,"Error: no room provided"));var n,t},ne=function e(n,t,o,a){Object(u.a)(this,e),this.title=n,this.roomId=t,this.from=o,this.to=a,this.id=void 0,this.confirmed=!1,this.by=void 0,this.attendees=void 0,this.agenda=void 0,this.id="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)})},te=Object(I.d)({slice:"allocation",initialState:{entity:{},ids:[]},reducers:{addAllocation:function(e,n){e.entity[n.payload.id]=n.payload,e.ids.push(n.payload.id)},finishEarly:function(e,n){e.entity[n.payload].to=Date.now()-6e4},extendMeeting:function(e,n){e.entity[n.payload.id].to+=n.payload.amount,e.entity[n.payload.id].confirmed=!0},confirmMeeting:function(e,n){e.entity[n.payload.id].confirmed=!0,e.entity[n.payload.id].from=Date.now()-6e4}}}),oe=t(25);!function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.Broken="Broken"}(y||(y={}));var ae=Object(I.d)({slice:"equipment",initialState:[],reducers:{addEquipment:function(e,n){return[].concat(Object(oe.a)(e),[n.payload])},setStatus:function(e,n){return e.filter(function(e){return e.roomId===n.payload.roomId&&e.type===n.payload.type})[0].status=n.payload.status,e},changeStatus:function(e,n){var t=e.filter(function(e){return e.roomId===n.payload.roomId&&e.type===n.payload.type})[0],o=y.Available;switch(t.status){case y.Available:o=y.Broken;break;case y.Broken:o=y.NotAvailable;break;case y.NotAvailable:o=y.Available}return t.status=o,e}}}),ie=Object(I.d)({slice:"ui",initialState:{selectedRoomId:"",time:Date.now(),adminPanelOpen:!1,syncInProgress:!1,syncError:""},reducers:{setSelectedRoomId:function(e,n){return e.selectedRoomId=n.payload,e},setTime:function(e,n){return e.time=n.payload,e},showAdminPanel:function(e){return e.adminPanelOpen=!0,e},hideAdminPanel:function(e){return e.adminPanelOpen=!1,e}}}),ce=Object(l.b)(function(e,n){console.log("mapState: ",e);var t,a=N(e),i=R(e),c=M(e),r=H(e),l=(t=12e4,Object(I.c)([W,F,N],function(e,n,a){return e?e.confirmed?o.occupied:o.awaiting:n&&n.from-a<t?n.confirmed?o.occupied:o.awaiting:o.free}))(e);return{currentAllocation:q(e)[0],equipment:r,nextAllocation:F(e),room:c,roomStatus:l,time:a,adminPanelOpen:i}},function(e){return{onAdminClick:function(){e(ie.actions.showAdminPanel())},onPopupCloseClick:function(){e(ie.actions.hideAdminPanel())},onAddMeetingClick:function(n){e(te.actions.addAllocation(Object(p.a)({},new ne("Ad hoc meeting",n,Date.now()-6e4,Date.now()+5e4),{confirmed:!0})))},onChangeStatusClick:function(n){e(ae.actions.changeStatus(n)),console.log("TODO change status. Ids need to be added to equipment")},onConfirmMeetingClick:function(n){e(te.actions.confirmMeeting({id:n}))},onExtendMeetingClick:function(n,t){e(te.actions.extendMeeting({id:n,amount:t}))},onFinishEarlyClick:function(n){e(te.actions.finishEarly(n))}}})(ee),re=(t(61),function(e){function n(){return Object(u.a)(this,n),Object(d.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(f.a)(n,e),Object(s.a)(n,[{key:"render",value:function(){return console.log("hello world","test"),i.a.createElement("div",{className:"App"},i.a.createElement(ce,null))}}]),n}(a.Component)),le=(t(63),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function ue(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var se=t(2),de=t(24),me=Object(se.combineReducers)({ui:ie.reducer,room:L.reducer,allocation:te.reducer,equipment:ae.reducer}),fe=Object(de.a)(me,function(e,n){var t=Object(p.a)({},e);switch(t.ui=Object(p.a)({},t.ui),n.type){case J.toString():return t.ui.syncInProgress=!0,t;case _.toString():return t.ui.syncInProgress=!1,t;case $.toString():return t.ui.syncInProgress=!1,t.ui.syncError=n.payload,t;case z.toString():return t.ui.syncInProgress=!0,t;case G.toString():return(t=Object(p.a)({},t,n.payload)).ui.syncInProgress=!1,t;case K.toString():return t.ui.syncInProgress=!1,t.ui.syncError=n.payload,t;default:return e}}),pe=Object(I.a)({reducer:fe});(function(){pe.subscribe(function(){console.log(pe.getState())}),pe.dispatch(X()),setInterval(function(){console.log("[Start] Interval"),pe.dispatch(ie.actions.setTime(Date.now())),pe.dispatch(Q())},6e4)})(),r.a.render(i.a.createElement(l.a,{store:pe},i.a.createElement(re,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rosi",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/rosi","/service-worker.js");le?(function(e,n){fetch(e).then(function(t){var o=t.headers.get("content-type");404===t.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ue(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):ue(n,e)})}}()}},[[26,2,1]]]);
//# sourceMappingURL=main.217113e4.chunk.js.map