(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,n){e.exports=n(65)},35:function(e,t,n){},37:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},45:function(e,t,n){},47:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},53:function(e,t,n){},55:function(e,t,n){},61:function(e,t,n){},63:function(e,t,n){},65:function(e,t,n){"use strict";n.r(t);var o,a=n(0),i=n.n(a),c=n(21),r=n.n(c),l=n(6),s=n(4),u=n(10),d=n(12),m=n(11),f=n(13),p=n(3),g=function(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},b=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},v=(n(35),function(e){return console.log("allocationInfo: ",e),i.a.createElement("div",{className:"AllocationInfo"},"Next Meeting:",i.a.createElement("div",null,g(e.from)," - ",g(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title))}),h=(n(37),function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"AllocationInfoBig"},"Current Meeting:",i.a.createElement("div",null,g(e.from)," - ",g(e.to)),i.a.createElement("div",null,e.by),i.a.createElement("div",null,e.title),e.attendees?i.a.createElement("div",null,"Attendees: ",e.attendees):null,e.agenda?i.a.createElement("div",null,"Agenda: ",e.agenda):null))});!function(e){e.occupied="occupied",e.free="free",e.awaiting="awaiting"}(o||(o={}));n(39);var y,E,C=function(e){var t=i.a.createElement("button",null,"Not configured button");switch(e.type){case"icon":t=i.a.createElement("button",{className:"btn ".concat(e.btnClassName),onClick:e.onClick,"aria-label":e.iconId},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})));break;case"icon-text":t=i.a.createElement("button",{className:"btn btn_flat",onClick:e.onClick,"aria-label":e.label},i.a.createElement("svg",{className:"icon"},i.a.createElement("use",{xlinkHref:"symbol-defs.svg#".concat(e.iconId)})),i.a.createElement("span",null,e.label))}return t},k=function(e){var t,n,a;console.log("Allocation menu:",e.id),console.log("Props: ",e),e.currentAllocation?(e.roomStatus===o.awaiting&&(n=i.a.createElement(C,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.currentAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{type:"icon-text",onClick:function(){return e.onExtendMeetingClick(e.currentAllocation.id,6e4)},iconId:"icon-calendar-plus-o",label:"Extend"}),i.a.createElement(C,{type:"icon-text",onClick:function(){return e.onFinishEarlyClick(e.currentAllocation.id)},iconId:"icon-calendar-times-o",label:"Finish"}),n)):(e.roomStatus===o.awaiting&&(a=i.a.createElement(C,{type:"icon-text",onClick:function(){return e.onConfirmMeetingClick(e.nextAllocation.id)},iconId:"icon-calendar-check-o",label:"Confirm"})),t=i.a.createElement(i.a.Fragment,null,i.a.createElement(C,{type:"icon-text",onClick:function(){return e.onAddMeetingClick(e.roomId)},iconId:"icon-calendar-o",label:"Book now"}),a));return i.a.createElement("div",{className:"AllocationMenu ".concat(e.roomStatus)},t)},x=(n(41),function(e){var t=["RoomStatusBorder"];return t.push(e.roomStatus),i.a.createElement("div",{className:t.join(" ")},e.children)}),O=(n(43),function(e){return i.a.createElement("div",{className:"StatusBar"},i.a.createElement("div",null,"This is StatusBar"),i.a.createElement(C,{type:"icon-text",onClick:e.onAdminClicked,iconId:"icon-settings",label:"Admin"}))}),w=(n(45),function(e){return i.a.createElement("div",{className:"TimeView"},g(e.time))}),j=(n(47),n(49),function(e){return i.a.createElement("div",{className:"EquipmentBar"},e.equipment.map(function(t){return function(t){return i.a.createElement(C,{key:t.type,type:"icon",onClick:function(){return e.onChangeStatusClick(t)},iconId:"icon-".concat(t.type.toLowerCase()),btnClassName:"btn_".concat(t.status.toLowerCase())})}(t)}))}),S=(n(51),function(e){return i.a.createElement("div",{className:"Header"},i.a.createElement("div",null,e.room.name),i.a.createElement(j,{equipment:e.equipment,onChangeStatusClick:e.onChangeStatusClick}))}),A=(n(53),n(55),function(){return i.a.createElement("div",{className:"Backdrop"})}),I=function(e){var t=["Popup"];return e.open&&t.push("open"),i.a.createElement("div",{className:t.join(" ")},i.a.createElement(A,null),i.a.createElement("div",{className:"content"},i.a.createElement(C,{type:"icon-text",onClick:e.onCloseClick,iconId:"icon-close",label:"Close"}),e.children))},N=n(1),R=Object(N.c)(["ui.time"]),P=Object(N.c)(["ui.selectedRoomId"]),M=Object(N.c)(["ui.adminPanelOpen"]),B=Object(N.c)([P,"room"],function(e,t){return t.entity[e]}),q=Object(N.c)([P,"allocation"],function(e,t){return Object.values(t.entity).filter(function(t){return t.roomId===e})}),D=Object(N.c)([R,q],function(e,t){return t.filter(function(t){return t.from<=e&&t.to>=e})}),T=Object(N.c)([R,q],function(e,t){return t.filter(function(t){return t.from>=e})}),F=Object(N.c)([T],function(e){return e.sort(function(e,t){return e.from-t.from})}),W=Object(N.c)([(y=1,Object(N.c)([F],function(e){return e.slice(0,y)}))],function(e){return e[0]}),H=Object(N.c)([D],function(e){return e[0]}),L=(Object(N.c)([D],function(e){return e.length>0}),Object(N.c)([P,"equipment"],function(e,t){return t.filter(function(t){return t.roomId===e})})),U=Object(N.d)({slice:"room",initialState:{entity:{},ids:[]},reducers:{addRoom:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},changeRoomName:function(e,t){e.entity[t.payload.id]?e.entity[t.payload.id].name=t.payload.name:(e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id))}}}),V=function e(t){Object(s.a)(this,e),this.name=t,this.id=void 0,this.capacity=void 0,this.location=void 0,this.equipment=void 0,this.id=b()},J=n(8),_=n.n(J),$=Object(N.b)("crossslice/savestate/started"),z=Object(N.b)("crossslice/savestate/succeeded"),G=Object(N.b)("crossslice/savestate/failed"),K=Object(N.b)("crossslice/loadstate/started"),Q=Object(N.b)("crossslice/loadstate/succeeded"),X=Object(N.b)("crossslice/loadstate/failed"),Y=function(){return function(e,t){return e($()),(n="state",o=t(),_.a.setItem(n,o)).then(function(){return e(z())},function(t){return e(G(t))});var n,o}},Z=function(){return function(e){return e(K()),(t="state",_.a.getItem(t)).then(function(t){return e(Q(t))},function(t){return e(X(t))});var t}},ee=Object(N.d)({slice:"ui",initialState:{selectedRoomId:"",time:Date.now(),adminPanelOpen:!1,syncInProgress:!1,syncError:""},reducers:{setSelectedRoomId:function(e,t){return e.selectedRoomId=t.payload,e},setTime:function(e,t){return e.time=t.payload,e},showAdminPanel:function(e){return e.adminPanelOpen=!0,e},hideAdminPanel:function(e){return e.adminPanelOpen=!1,e}}}),te=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).selectedRoom=void 0,console.log("!!props",e),n.selectedRoom=e.selectedRoom,n.selectedRoom||(n.selectedRoom=Object(p.a)({},new V("Conference Room 1"))),n.state={room:Object(p.a)({},n.selectedRoom)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"submitSettings",value:function(e){e.preventDefault(),console.log(e),this.props.onSettingsSaved(this.state.room)}},{key:"inputChangedHandler",value:function(e){console.log(e);var t=Object(p.a)({},this.state);t.room.name=e.target.value,this.setState(t)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("h3",null,"This is admin panel"),i.a.createElement("form",{onSubmit:function(t){return e.submitSettings(t)}},i.a.createElement("div",null,i.a.createElement("label",null,"Room name"),i.a.createElement("input",{type:"text",placeholder:"Room Name",value:this.state.room.name,onChange:function(t){return e.inputChangedHandler(t)}})),i.a.createElement(C,{type:"icon-text",iconId:"icon-save",label:"Save Settings"})))}}]),t}(a.Component),ne=Object(l.b)(function(e){return{selectedRoom:B(e)}},function(e){return{onSettingsSaved:function(t){e(U.actions.changeRoomName(t)),e(ee.actions.setSelectedRoomId(t.id)),e(Y())}}})(te),oe=function(e){return console.log("roomView: ",e),e.room?(e.currentAllocation&&(t=i.a.createElement(h,e.currentAllocation)),e.nextAllocation&&(n=i.a.createElement(v,e.nextAllocation)),i.a.createElement("div",{className:"RoomView"},i.a.createElement(S,Object.assign({time:e.time},e)),i.a.createElement(x,{roomStatus:e.roomStatus},i.a.createElement(w,{time:e.time}),i.a.createElement("div",{className:"Separator"}),i.a.createElement("div",{className:"RightSection"},i.a.createElement("div",{className:"Allocations"},t,n),i.a.createElement(k,{currentAllocation:e.currentAllocation,nextAllocation:e.nextAllocation,roomStatus:e.roomStatus,roomId:e.room.id,onFinishEarlyClick:e.onFinishEarlyClick,onExtendMeetingClick:e.onExtendMeetingClick,onConfirmMeetingClick:e.onConfirmMeetingClick,onAddMeetingClick:e.onAddMeetingClick}))),i.a.createElement(O,{onAdminClicked:e.onAdminClick}),i.a.createElement(I,{open:e.adminPanelOpen,onCloseClick:e.onPopupCloseClick},i.a.createElement(ne,null)))):(console.error("[RoomView] No room provided!"),i.a.createElement(ne,null));var t,n},ae=function e(t,n,o,a){Object(s.a)(this,e),this.title=t,this.roomId=n,this.from=o,this.to=a,this.id=void 0,this.confirmed=!1,this.by=void 0,this.attendees=void 0,this.agenda=void 0,this.id=b()},ie=Object(N.d)({slice:"allocation",initialState:{entity:{},ids:[]},reducers:{addAllocation:function(e,t){e.entity[t.payload.id]=t.payload,e.ids.push(t.payload.id)},finishEarly:function(e,t){e.entity[t.payload].to=Date.now()-6e4},extendMeeting:function(e,t){e.entity[t.payload.id].to+=t.payload.amount,e.entity[t.payload.id].confirmed=!0},confirmMeeting:function(e,t){e.entity[t.payload.id].confirmed=!0,e.entity[t.payload.id].from=Date.now()-6e4}}}),ce=n(25);!function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.Broken="Broken"}(E||(E={}));var re=Object(N.d)({slice:"equipment",initialState:[],reducers:{addEquipment:function(e,t){return[].concat(Object(ce.a)(e),[t.payload])},setStatus:function(e,t){return e.filter(function(e){return e.roomId===t.payload.roomId&&e.type===t.payload.type})[0].status=t.payload.status,e},changeStatus:function(e,t){var n=e.filter(function(e){return e.roomId===t.payload.roomId&&e.type===t.payload.type})[0],o=E.Available;switch(n.status){case E.Available:o=E.Broken;break;case E.Broken:o=E.NotAvailable;break;case E.NotAvailable:o=E.Available}return n.status=o,e}}}),le=Object(l.b)(function(e,t){console.log("mapState: ",e);var n,a=R(e),i=M(e),c=B(e),r=L(e),l=(n=12e4,Object(N.c)([H,W,R],function(e,t,a){return e?e.confirmed?o.occupied:o.awaiting:t&&t.from-a<n?t.confirmed?o.occupied:o.awaiting:o.free}))(e);return{currentAllocation:D(e)[0],equipment:r,nextAllocation:W(e),room:c,roomStatus:l,time:a,adminPanelOpen:i}},function(e){return{onAdminClick:function(){e(ee.actions.showAdminPanel())},onPopupCloseClick:function(){e(ee.actions.hideAdminPanel())},onAddMeetingClick:function(t){e(ie.actions.addAllocation(Object(p.a)({},new ae("Ad hoc meeting",t,Date.now()-6e4,Date.now()+5e4),{confirmed:!0})))},onChangeStatusClick:function(t){e(re.actions.changeStatus(t)),console.log("TODO change status. Ids need to be added to equipment")},onConfirmMeetingClick:function(t){e(ie.actions.confirmMeeting({id:t}))},onExtendMeetingClick:function(t,n){e(ie.actions.extendMeeting({id:t,amount:n}))},onFinishEarlyClick:function(t){e(ie.actions.finishEarly(t))}}})(oe),se=(n(61),function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log("hello world","test"),i.a.createElement("div",{className:"App"},i.a.createElement(le,null))}}]),t}(a.Component)),ue=(n(63),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function de(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var me=n(2),fe=n(24),pe=Object(me.combineReducers)({ui:ee.reducer,room:U.reducer,allocation:ie.reducer,equipment:re.reducer}),ge=Object(fe.a)(pe,function(e,t){var n=Object(p.a)({},e);switch(n.ui=Object(p.a)({},n.ui),t.type){case $.toString():return n.ui.syncInProgress=!0,n;case z.toString():return n.ui.syncInProgress=!1,n;case G.toString():return n.ui.syncInProgress=!1,n.ui.syncError=t.payload,n;case K.toString():return n.ui.syncInProgress=!0,n;case Q.toString():return(n=Object(p.a)({},n,t.payload)).ui.syncInProgress=!1,n;case X.toString():return n.ui.syncInProgress=!1,n.ui.syncError=t.payload,n;default:return e}}),be=Object(N.a)({reducer:ge});(function(){var e=be.getState();console.log("[Start] startState:",e),be.dispatch(Z()),setInterval(function(){console.log("[Start] Interval"),be.dispatch(ee.actions.setTime(Date.now())),be.dispatch(Y())},6e4)})(),r.a.render(i.a.createElement(l.a,{store:be},i.a.createElement(se,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rosi",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/rosi","/service-worker.js");ue?(function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):de(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):de(t,e)})}}()}},[[26,2,1]]]);
//# sourceMappingURL=main.cd5cdc48.chunk.js.map